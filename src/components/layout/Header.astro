---
import ThemeToggle from "../ThemeToggle.astro";
import Search from "../Search.astro";
import { menuLinks } from "@/site-config";

const url = new URL(Astro.request.url);
---

<header id="main-header" class="group relative mb-12 flex items-center">
	<div class="flex w-full flex-col justify-between">
		<nav
			id="navigation-menu"
			class="align-center font-ui flex place-items-center"
			aria-label="Main menu"
		>
			<span class="flex-grow">
				<a class="internal-link plain" href="/">
					<svg
						class="h-7 w-auto"
						viewBox="0 0 3153 719"
						version="1.1"
						xmlns="http://www.w3.org/2000/svg"
						><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"
							><g class="fill-primary"
								><g transform="translate(2550.000000, 4.000000)" fill-rule="nonzero"
									><g
										transform="translate(301.500000, 356.500000) scale(-1, 1) rotate(-180.000000) translate(-301.500000, -356.500000) "
										><path
											d="M296.075,709.328658 C180.7,690.237678 79.625,611.898828 31.2,504.265199 C15.6,469.045632 4.225,425.26804 1.95,389.390163 L0,358.778764 L42.25,358.778764 L84.5,358.778764 L88.4,388.402699 C101.725,494.061399 169.65,577.666726 270.725,612.886293 C300.3,623.090092 303.875,623.419247 350.35,623.748402 C387.4,623.748402 404.3,622.102628 420.225,617.823615 C451.1,608.936435 496.925,585.566442 520.65,565.817152 L541.125,548.701101 L571.675,579.641655 L601.9,610.582209 L581.1,628.685724 C519.675,681.350497 446.55,709.657812 364.975,712.620206 C338.65,713.60767 314.6,712.291051 296.075,709.328658 Z"
											id="Path"></path><path
											d="M530.4,156.019389 C517.4,141.865732 475.475,115.533345 449.475,105.329545 C426.4,96.4423651 404.625,91.5050426 367.575,87.2260298 L351.975,85.2511009 L351.975,42.460973 L351.975,0 L369.525,0 C438.75,0 523.25,34.2321023 583.7,86.5677202 L602.55,103.025462 L572.325,133.966016 C555.75,150.752912 541.45,164.577415 540.15,164.577415 C539.175,164.577415 534.95,160.627557 530.4,156.019389 Z"
											id="Path"></path></g
									></g
								><g transform="translate(255.000000, 1.000000)" fill-rule="nonzero"
									><g
										transform="translate(232.500000, 358.000000) scale(-1, 1) rotate(-180.000000) translate(-232.500000, -358.000000) "
										><path
											d="M183.54,711.42891 C96.14,694.922438 25.08,632.527977 6.46,555.937951 C-9.5,490.242195 14.44,420.254757 69.54,372.385991 C83.98,360.171202 97.28,349.93719 99.18,349.93719 C101.46,349.93719 103.36,385.591168 104.12,446.665111 L105.26,543.062903 L115.14,561.550151 C120.84,572.114293 132.62,586.639987 141.36,594.232964 C150.1,601.825941 166.82,612.059953 178.98,617.011894 C197.22,624.274742 205.2,625.595259 234.46,625.595259 C262.96,625.26513 272.08,623.944612 287.66,617.342024 C328.32,600.175294 361.76,558.909116 361.76,526.556432 L361.76,515.001902 L413.06,515.001902 L464.36,515.001902 L464.36,525.896173 C463.98,558.248857 444.22,604.797106 416.48,637.810048 C366.7,696.573086 269.04,727.275122 183.54,711.42891 Z"
											id="Path"></path><path
											d="M361,266.744575 L359.86,166.715359 L349.6,150.208888 C316.92,97.0580508 242.06,72.9586028 182.4,96.3977919 C140.6,113.234393 110.2,146.577464 104.88,182.231442 L102.22,198.077655 L51.3,198.077655 L0,198.077655 L2.66,179.260277 C16.72,76.259897 114.38,0 231.42,0 C273.22,0 296.78,4.62181194 335.16,20.4680243 C360.62,31.0321659 373.54,39.2854015 395.96,59.093167 C429.02,87.8144269 446.12,113.564522 456.76,150.539018 C470.82,198.737914 465.5,242.314998 439.66,288.863246 C427.88,309.99153 416.86,324.517224 400.52,339.042919 C359.1,375.687285 362.52,381.959744 361,266.744575 Z"
											id="Path"></path></g
									></g
								><polygon points="0 0 134.880512 83.5592434 135 716 0 716"></polygon><g
									transform="translate(820.000000, 0.000000)"
									><path
										d="M574.481061,387 L600.77934,387.554463 L764.242086,714.539978 L636.082757,714.539978 L521.287,487.554 L275,487.554463 L275,387.554463 L470.713,387.554 L470.43379,387 L574.481061,387 Z"
										id="Combined-Shape"></path><path
										d="M130.518939,0 L325.471,388.014 L325.518939,388.014485 L325.518,388.108 L489.761024,715 L361.601695,715 L246.806,488.014 L0.518938562,488.014485 L0.518938562,388.014485 L196.233,388.014 L2.84217094e-14,0 L130.518939,0 Z"
										id="Combined-Shape"
										transform="translate(244.880512, 357.500000) scale(-1, 1) translate(-244.880512, -357.500000) "
									></path></g
								><g transform="translate(1685.000000, 4.000000)"
									><path
										d="M574.481061,387 L600.77934,387.554463 L764.242086,714.539978 L636.082757,714.539978 L521.287,487.554 L275,487.554463 L275,387.554463 L470.713,387.554 L470.43379,387 L574.481061,387 Z"
										id="Combined-Shape"></path><path
										d="M130.518939,0 L325.471,388.014 L325.518939,388.014485 L325.518,388.108 L489.761024,715 L361.601695,715 L246.806,488.014 L0.518938562,488.014485 L0.518938562,388.014485 L196.233,388.014 L2.84217094e-14,0 L130.518939,0 Z"
										id="Combined-Shape"
										transform="translate(244.880512, 357.500000) scale(-1, 1) translate(-244.880512, -357.500000) "
									></path></g
								></g
							></g
						></svg
					></a
				>
			</span>
			<span class="ssr flex-shrin mr-6">
				{
					menuLinks.map((link) => (
						<a
							href={link.path}
							class="muted plain"
							aria-current={url.pathname === link.path ? "page" : false}
							data-astro-prefetch
						>
							{link.title}
						</a>
					))
				}
			</span>
		</nav>
	</div>
	<Search />
	<ThemeToggle />
	<!-- <mobile-button>
		<button
			id="toggle-navigation-menu"
			class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden"
			type="button"
			aria-label="Open main menu"
			aria-expanded="false"
			aria-haspopup="menu"
		>
			<svg
				id="line-svg"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
				aria-hidden="true"
				focusable="false"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 24 24"
				stroke-width="1.5"
				stroke="currentColor"
			>
				<path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"
				></path>
			</svg>
			<svg
				id="cross-svg"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
				class="text-accent"
				aria-hidden="true"
				focusable="false"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 24 24"
				stroke-width="1.5"
				stroke="currentColor"
			>
				<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
			</svg>
		</button>
	</mobile-button> -->
</header>

<script>
	import { toggleClass } from "@/utils";

	class MobileNavBtn extends HTMLElement {
		private headerEl: HTMLElement;
		private mobileButtonEl: HTMLButtonElement;
		private menuOpen: boolean;

		constructor() {
			super();
			this.headerEl = document.getElementById("main-header")!;
			this.mobileButtonEl = this.querySelector("button") as HTMLButtonElement;
			this.menuOpen = false;

			this.mobileButtonEl.addEventListener("click", this.toggleMobileMenu);
		}

		toggleMobileMenu = () => {
			toggleClass(this.headerEl, "menu-open");
			this.menuOpen = !this.menuOpen;
			this.mobileButtonEl.setAttribute("aria-expanded", this.menuOpen.toString());
		};
	}

	customElements.define("mobile-button", MobileNavBtn);
</script>
